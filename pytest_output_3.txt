============================= test session starts =============================
platform win32 -- Python 3.13.2, pytest-8.4.2, pluggy-1.6.0
rootdir: C:\1GitRepos\crop-rotation
plugins: anyio-4.9.0, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 3 items

tests\test_smoke.py FFF                                                  [100%]

================================== FAILURES ===================================
_____________________________ test_homepage_loads _____________________________

client = <FlaskClient <Flask 'app'>>

    def test_homepage_loads(client):
        """Test that the homepage loads successfully."""
>       rv = client.get('/')
             ^^^^^^^^^^^^^^^

tests\test_smoke.py:30: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\test.py:1162: in get
    return self.open(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\testing.py:235: in open
    response = super().open(
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:1536: in __call__
    return self.wsgi_app(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:1514: in wsgi_app
    response = self.handle_exception(e)
               ^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:1511: in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:919: in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:917: in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:902: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
routes\main.py:56: in index
    return render_template(
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\templating.py:150: in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\templating.py:131: in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py:1295: in render
    self.environment.handle_exception()
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py:942: in handle_exception
    raise rewrite_traceback_stack(source=source)
templates\index.html:1: in top-level template code
    {% extends "base.html" %}
templates\base.html:78: in top-level template code
    {% block content %}{% endblock %}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
templates\index.html:88: in block 'content'
    <a href="{{ url_for('cycle.bootstrap', garden_id=selected_garden_id) }}" class="btn btn-primary btn-lg">
    ^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:1121: in url_for
    return self.handle_url_build_error(error, endpoint, values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:1110: in url_for
    rv = url_adapter.build(  # type: ignore[union-attr]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <werkzeug.routing.map.MapAdapter object at 0x000002295561BB60>
endpoint = 'cycle.bootstrap', values = {}, method = None, force_external = False
append_unknown = True, url_scheme = None

    def build(
        self,
        endpoint: t.Any,
        values: t.Mapping[str, t.Any] | None = None,
        method: str | None = None,
        force_external: bool = False,
        append_unknown: bool = True,
        url_scheme: str | None = None,
    ) -> str:
        """Building URLs works pretty much the other way round.  Instead of
        `match` you call `build` and pass it the endpoint and a dict of
        arguments for the placeholders.
    
        The `build` function also accepts an argument called `force_external`
        which, if you set it to `True` will force external URLs. Per default
        external URLs (include the server name) will only be used if the
        target URL is on a different subdomain.
    
        >>> m = Map([
        ...     Rule('/', endpoint='index'),
        ...     Rule('/downloads/', endpoint='downloads/index'),
        ...     Rule('/downloads/<int:id>', endpoint='downloads/show')
        ... ])
        >>> urls = m.bind("example.com", "/")
        >>> urls.build("index", {})
        '/'
        >>> urls.build("downloads/show", {'id': 42})
        '/downloads/42'
        >>> urls.build("downloads/show", {'id': 42}, force_external=True)
        'http://example.com/downloads/42'
    
        Because URLs cannot contain non ASCII data you will always get
        bytes back.  Non ASCII characters are urlencoded with the
        charset defined on the map instance.
    
        Additional values are converted to strings and appended to the URL as
        URL querystring parameters:
    
        >>> urls.build("index", {'q': 'My Searchstring'})
        '/?q=My+Searchstring'
    
        When processing those additional values, lists are furthermore
        interpreted as multiple values (as per
        :py:class:`werkzeug.datastructures.MultiDict`):
    
        >>> urls.build("index", {'q': ['a', 'b', 'c']})
        '/?q=a&q=b&q=c'
    
        Passing a ``MultiDict`` will also add multiple values:
    
        >>> urls.build("index", MultiDict((('p', 'z'), ('q', 'a'), ('q', 'b'))))
        '/?p=z&q=a&q=b'
    
        If a rule does not exist when building a `BuildError` exception is
        raised.
    
        The build method accepts an argument called `method` which allows you
        to specify the method you want to have an URL built for if you have
        different methods for the same endpoint specified.
    
        :param endpoint: the endpoint of the URL to build.
        :param values: the values for the URL to build.  Unhandled values are
                       appended to the URL as query parameters.
        :param method: the HTTP method for the rule if there are different
                       URLs for different methods on the same endpoint.
        :param force_external: enforce full canonical external URLs. If the URL
                               scheme is not provided, this will generate
                               a protocol-relative URL.
        :param append_unknown: unknown parameters are appended to the generated
                               URL as query string argument.  Disable this
                               if you want the builder to ignore those.
        :param url_scheme: Scheme to use in place of the bound
            :attr:`url_scheme`.
    
        .. versionchanged:: 2.0
            Added the ``url_scheme`` parameter.
    
        .. versionadded:: 0.6
           Added the ``append_unknown`` parameter.
        """
        self.map.update()
    
        if values:
            if isinstance(values, MultiDict):
                values = {
                    k: (v[0] if len(v) == 1 else v)
                    for k, v in dict.items(values)
                    if len(v) != 0
                }
            else:  # plain dict
                values = {k: v for k, v in values.items() if v is not None}
        else:
            values = {}
    
        rv = self._partial_build(endpoint, values, method, append_unknown)
        if rv is None:
>           raise BuildError(endpoint, values, method, self)
E           werkzeug.routing.exceptions.BuildError: Could not build url for endpoint 'cycle.bootstrap'. Did you forget to specify values ['garden_id']?

C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\routing\map.py:924: BuildError
_____________________________ test_static_assets ______________________________

client = <FlaskClient <Flask 'app'>>

    def test_static_assets(client):
        """Test that static assets like CSS are accessible."""
        rv = client.get('/static/style.css')
>       assert rv.status_code == 200
E       assert 404 == 200
E        +  where 404 = <WrapperTestResponse streamed [404 NOT FOUND]>.status_code

tests\test_smoke.py:40: AssertionError
_____________________________ test_settings_page ______________________________

client = <FlaskClient <Flask 'app'>>

    def test_settings_page(client):
        """Test that the settings page loads."""
>       rv = client.get('/settings/')
             ^^^^^^^^^^^^^^^^^^^^^^^^

tests\test_smoke.py:44: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\test.py:1162: in get
    return self.open(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\testing.py:235: in open
    response = super().open(
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\werkzeug\test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:1536: in __call__
    return self.wsgi_app(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:1514: in wsgi_app
    response = self.handle_exception(e)
               ^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:1511: in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:919: in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:917: in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\app.py:902: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
routes\settings.py:70: in index
    return render_template('settings.html',
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\templating.py:150: in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\flask\templating.py:131: in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py:1295: in render
    self.environment.handle_exception()
C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py:942: in handle_exception
    raise rewrite_traceback_stack(source=source)
templates\settings.html:1: in top-level template code
    {% extends "base.html" %}
templates\base.html:78: in top-level template code
    {% block content %}{% endblock %}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
templates\settings.html:359: in block 'content'
    <span class="rotation-wrap">(retour ï¿½ {{ rotation[0].category }})</span>
    ^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <flask.templating.Environment object at 0x0000022955B65D10>
obj = Undefined, attribute = 'category'

    def getattr(self, obj: t.Any, attribute: str) -> t.Any:
        """Get an item or attribute of an object but prefer the attribute.
        Unlike :meth:`getitem` the attribute *must* be a string.
        """
        try:
>           return getattr(obj, attribute)
                   ^^^^^^^^^^^^^^^^^^^^^^^
E           jinja2.exceptions.UndefinedError: list object has no element 0

C:\Users\Biaou\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py:490: UndefinedError
=========================== short test summary info ===========================
FAILED tests/test_smoke.py::test_homepage_loads - werkzeug.routing.exceptions...
FAILED tests/test_smoke.py::test_static_assets - assert 404 == 200
FAILED tests/test_smoke.py::test_settings_page - jinja2.exceptions.UndefinedE...
============================== 3 failed in 1.67s ==============================
